{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/rules.schema.json",
  "title": "Xiaoliu Rule",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "id": { "type": "string", "pattern": "^RL-[0-9A-Za-z_-]+$" },
    "title": { "type": "string", "minLength": 1 },
    "description": { "type": "string" },
    "role_scope": {
      "type": "array",
      "items": { "type": "string", "enum": [
        "user_manager", "product_manager", "developer", "observer",
        "plugin", "backend", "qa"
      ] },
      "minItems": 1,
      "uniqueItems": true
    },
    "level": { "type": "string", "enum": ["core", "high", "medium", "low"] },
    "priority": { "type": "integer", "minimum": 1, "maximum": 5 },
    "version": { "type": "string", "pattern": "^v?[0-9]+\\.[0-9]+(\\.[0-9]+)?$" },
    "enabled": { "type": "boolean" },
    "tags": { "type": "array", "items": { "type": "string" }, "uniqueItems": true },
    "selector": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task_types": { "type": "array", "items": { "type": "string" }, "uniqueItems": true },
        "roles": { "type": "array", "items": { "type": "string" }, "uniqueItems": true },
        "languages": { "type": "array", "items": { "type": "string" }, "uniqueItems": true },
        "paths": { "type": "array", "items": { "type": "string" }, "uniqueItems": true }
      }
    },
    "text": { "type": "string", "minLength": 1 },
    "examples": {
      "type": "object",
      "properties": {
        "good": { "type": "string" },
        "bad": { "type": "string" }
      }
    },
    "source": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "document": { "type": "string" },
        "file": { "type": "string" },
        "line": { "type": "integer", "minimum": 1 }
      }
    },
    "conflicts": { "type": "array", "items": { "type": "string" }, "uniqueItems": true },
    "merge_strategy": { "type": "string", "enum": [
      "prefer_high_priority", "prefer_latest", "merge_text", "drop_conflict"
    ] },
    "ruleset": { "type": "string" },
    "lint": {
      "type": "object",
      "properties": {
        "regex": { "type": "array", "items": { "type": "string" } },
        "ast": { "type": "array", "items": { "type": "string" } }
      }
    },
    "checksum": { "type": "string" },
    "created_at": { "type": "string", "format": "date-time" },
    "updated_at": { "type": "string", "format": "date-time" }
  },
  "required": [
    "id", "title", "text", "role_scope", "level", "priority", "enabled", "version"
  ]
}
