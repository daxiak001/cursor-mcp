# S3 任务清单（VDCP 核心域）

目标：在核心/高风险模块落地 AST 受控变更 + 契约双向校验 + 差异覆盖选测。

最小任务：
1. 选定核心模块（如 auth、billing、rules-engine），建立“核心域清单”
2. 新增 MCP 工具 `apply_ast_patch`（仅接受AST Patch JSON，由工具生成代码）
3. 契约双向校验：OpenAPI/JSON-Schema 与代码DTO/路由一致性检查
4. 差异覆盖：仅针对本次diff影响面跑必要测试；设置核心域覆盖率阈值（≥80%）
5. 基础不变量规则：无敏感字面量、资源释放、必经错误处理、幂等/时序（可分步落地）
6. 在 ./快速索引.md 与 ./项目计划表.md 标注“核心域流程”入口
7. 对第一个核心模块完成一次从AST补丁→契约校验→选测→登记的闭环，并在 ./阶段登记表.md 记[#STAGE]

验收标准：
- 核心域遵守率≈99%；覆盖率阈值达标
- AST补丁流程跑通（AI不直接写自由文本代码）
